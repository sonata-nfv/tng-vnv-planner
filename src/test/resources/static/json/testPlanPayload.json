{
  "id": 0,
  "test_plans": [
    {
      "description": "Test Plan Description: confirm required but not confirmed",
      "id": 0,
      "index": 1,
      "nsd": {
        "vendor": "eu.sonata-nfv",
        "name": "mediapilot-service",
        "version": "0.2",
        "author": "Ignacio Dominguez @: atos",
        "description": "This NS provides the video streaming service for the immersive media pilot.",
        "testing_tags": [
          "rtmp-media-service"
        ]
      },
      "testd": {
        "confirm_required": "1",
        "validate": "1",
        "test_tags": [
          "rtmp-media-service"
        ]
      }
    },
    {
      "description": "Test Plan Description: Confirm required and confirmed",
      "id": 0,
      "index": 1,
      "nsd": {
        "vendor": "eu.sonata-nfv",
        "name": "mediapilot-service",
        "version": "0.2",
        "author": "Ignacio Dominguez @: atos",
        "description": "This NS provides the video streaming service for the immersive media pilot.",
        "testing_tags": [
          "rtmp-media-service"
        ]
      },
      "testd": {
        "confirm_required": "1",
        "confirmed": "1",
        "validate": "1",
        "test_tags": [
          "rtmp-media-service"
        ]
      }
    },
    {
      "description": "Test Plan Description: Adhoc TD,NSD request for testing",
      "id": 1,
      "index": 2,
      "nsd": {
        "vendor": "eu.sonata-nfv",
        "name": "mediapilot-service",
        "version": "0.2",
        "author": "Ignacio Dominguez @: atos",
        "description": "This NS provides the video streaming service for the immersive media pilot.",
        "network_functions": [
          {
            "vnf_id": "vnf-ma",
            "vnf_vendor": "eu.5gtango",
            "vnf_name": "ma-vnfd-k8s",
            "vnf_version": "0.2"
          },
          {
            "vnf_id": "vnf-mse",
            "vnf_vendor": "eu.5gtango",
            "vnf_name": "mse-vnfd-k8s",
            "vnf_version": "0.2"
          },
          {
            "vnf_id": "vnf-cms",
            "vnf_vendor": "eu.5gtango",
            "vnf_name": "cms-vnfd-k8s",
            "vnf_version": "0.1"
          }
        ],
        "connection_points": [
          {
            "id": "nscpexternal",
            "interface": "ipv4",
            "type": "external"
          }
        ],
        "testing_tags": [
          "rtmp-media-service"
        ],
        "virtual_links": [
          {
            "id": "vlexternal",
            "connectivity_type": "E-LAN",
            "connection_points_reference": [
              "vnf-ma:rtmp",
              "vnf-mse:hls",
              "vnf-cms:api",
              "nscpexternal"
            ]
          },
          {
            "id": "cms-aggregator",
            "connectivity_type": "E-Line",
            "connection_points_reference": [
              "vnf-cms:api",
              "vnf-ma:api"
            ]
          },
          {
            "id": "aggregator-mse",
            "connectivity_type": "E-Line",
            "connection_points_reference": [
              "vnf-ma:rtmp",
              "vnf-mse:rtmp"
            ]
          }
        ]
      },
      "status": "string",
      "testd": {
        "author": "Ignacio Dominguez, Felipe Vicens (ATOS)",
        "description": "Performance test for video analysis",
        "name": "test-immersive-media",
        "vendor": "eu.5gtango.atos",
        "version": "0.1",
        "phases": [
          {
            "id": "setup",
            "steps": [
              {
                "action": "deploy",
                "description": "Deploying a NS",
                "name": "deployment"
              },
              {
                "action": "configure",
                "description": null,
                "name": "configuration",
                "probes": [
                  {
                    "description": "A service initial configuration container",
                    "id": "initiator",
                    "image": "ignaciodomin/media-initiator:dev",
                    "name": "initiator",
                    "parameters": [
                      {
                        "key": "CAMERA",
                        "value": "test"
                      },
                      {
                        "key": "CMS",
                        "value": "$(vnf-cms/endpoints/id:floating-ip/address)"
                      },
                      {
                        "key": "MA",
                        "value": "$(vnf-ma/endpoints/id:floating-ip/address)"
                      },
                      {
                        "key": "MSE",
                        "value": "$(vnf-mse/endpoints/id:floating-ip/address)"
                      }
                    ]
                  },
                  {
                    "id": "ffprobe",
                    "name": "ffprobe",
                    "image": "ignaciodomin/media-ffprobe:dev",
                    "description": "Ffprobe",
                    "parameters": [
                      {
                        "key": "STREAMING_ENGINE",
                        "value": "$(vnf-mse/endpoints/id:floating-ip/address)"
                      },
                      {
                        "key": "STREAM",
                        "value": "plane"
                      }
                    ]
                  },
                  {
                    "id": "parser",
                    "name": "parser",
                    "image": "ignaciodomin/media-parser:dev",
                    "description": "Parser",
                    "parameters": [
                    ]
                  },
                  {
                    "description": "Content Producer Emulator (CPE) To generate a RTMP flow",
                    "id": "cpe",
                    "image": "ignaciodomin/media-cpe:plane",
                    "name": "cpe",
                    "parameters": [
                      {
                        "key": "AGGREGATOR",
                        "value": "$(vnf-ma/endpoints/id:floating-ip/address)"
                      },
                      {
                        "key": "APP",
                        "value": "test"
                      },
                      {
                        "key": "STREAM",
                        "value": "test"
                      }
                    ]
                  },
                  {
                    "description": "Content Consumer Emulator (CCE) To play HLS flows from Streaming engine",
                    "id": "cce",
                    "image": "ignaciodomin/media-cce:dev",
                    "name": "cce",
                    "parameters": [
                      {
                        "key": "STREAMMING_ENGINE",
                        "value": "$(vnf-mse/endpoints/id:floating-ip/address)"
                      },
                      {
                        "key": "STREAM",
                        "value": "test"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "id": "exercise",
            "steps": [
              {
                "name": "cpe",
                "description": "Starting the CPE that simulates the camera",
                "run": "cpe",
                "index": 1,
                "entrypoint": "/app/entrypoint.sh",
                "command": "/bin/sh",
                "instances": 1,
                "output": [
                  {
                    "results": "logs.txt"
                  }
                ]
              },
              {
                "name": "ffprobe",
                "description": "Starting the CCE that simulates the consumer",
                "run": "ffprobe",
                "index": 2,
                "entrypoint":"/app/entrypoint.sh",
                "start_delay": 5,
                "instances": 1,
                "output": [
                  {
                    "results": "logs.txt"
                  }
                ]
              },
              {
                "name": "cce",
                "description": "Starting the CCE that simulates the consumer",
                "run": "cce",
                "index": 3,
                "entrypoint":"/app/entrypoint.sh",
                "start_delay": 20,
                "instances": 1,
                "output": [
                  {
                    "results": "logs.txt"
                  }
                ]
              },
              {
                "name": "parser",
                "description": "Starting the CCE that simulates the consumer",
                "run": "parser",
                "index": 4,
                "entrypoint":"/app/entrypoint.sh",
                "instances": 1,
                "output": [
                  {
                    "results": "logs.txt"
                  }
                ],
                "dependencies": [
                  "cpe",
                  "ffprobe",
                  "cce"
                ]
              }
            ]
          },
          {
            "id": "verification",
            "steps": [
              {
                "name": "cpe",
                "description": "Check cpe",
                "step": "cpe",
                "conditions": [
                  {
                    "name": "status",
                    "file": "status.txt",
                    "find": "ERROR",
                    "condition": "not present",
                    "verdict": "pass"
                  }
                ]
              },
              {
                "name": "cce",
                "description": "Check cce",
                "step": "cce",
                "conditions": [
                  {
                    "name": "status",
                    "file": "status.txt",
                    "find": "ERROR",
                    "condition": "not present",
                    "verdict": "pass"
                  }
                ]
              },
              {
                "name": "ffprobe",
                "description": "Check ffprobe",
                "step": "ffprobe",
                "conditions": [
                  {
                    "name": "status",
                    "file": "status.txt",
                    "find": "ERROR",
                    "condition": "not present",
                    "verdict": "pass"
                  }
                ]
              },
              {
                "name": "parser",
                "description": "Check obtained results",
                "step": "parser",
                "conditions": [
                  {
                    "name": "lost-frames",
                    "file": "result.json",
                    "type": "json",
                    "find": "lost-frames",
                    "condition": "<",
                    "value": "90",
                    "verdict": "pass"
                  }
                ]
              }
            ]
          }
        ],
        "service_platforms": [
          "SONATA"
        ],
        "test_category": [
          "benchmarking"
        ],
        "test_tags": [
          "rtmp-media-service"
        ]
      },
      "uuid": "1"
    }
  ]
}

